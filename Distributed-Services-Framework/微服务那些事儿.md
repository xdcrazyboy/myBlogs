阅读书目：《微服务那些事儿》，鼓励大家支持，书很薄。

## 为什么选择微服务

### 别人挫呀-传统架构的问题
1. 笨拙
2. 耦合严重
3. 协作困难
4. 无法持续交付
5. 受技术栈限制-技术选型受限
6. 债务多，该bug太难了，越改越多
   
### 微服务可以解决那些挫
1. 架构轻量灵活、可应付需求的变化
2. 可持续交付
3. 业务敏捷
4. 独立演进
5. 高可用、高性能
6. 站在云端

### 业务能力的拆分是核心 
1. 拆还是不拆？（耦合、解耦共用代码改多处、收益在哪里？）
2. 如何拆？（熟悉系统：数据模型和业务模型、金字塔结构）
   * 关键指标
        1. 公共的业务功能
        2. 重点业务
        3. 对系统影响大的业务功能
        4. 经常变化的业务主体
        5. 特殊业务主体
        6. 不同业务渠道
3. 粒度  （结合实际情况，循序渐进，抓大放小）
4. 边界 （边界清晰、分工明确）

无关其技、唯手熟尔。

### 如何使用微服务
1. 如何规划
    * 全局性
    * 针对性
    * 良性发展
    * 格局大
2. 微服务重构
   * 影响因素
   * 重构原则
        > 前后端分离、代价最小原则、影响最小原则、吐故纳新。
    * 重构方法
        > 接骨法（服务化，Rest接口，消息队列，管道链接业务）、分批逃跑法（分批拆）、
        >修路法（占用部分车道，保证路还是可以通的）

不要低估了微服务的复杂度、也不要觉得微服务国语复杂。

### 微服务的朋友圈
1. 容器（容器的标签就是隔离；微服务拆分太多，部署复杂，而容器就相当于微服务的东风；）
   * 好处：环境一致性、减少了部署的重复工作、快速交付、安全性高、易集成、自带体系
2. DevOps（开发+运维），跟微服务天生一对，以前团队人少可以践行DevOps，现在用微服务，团队拆分之后，又恢复到了以前。
3. SOA（面向服务的架构）有ESB，Web Service，不过跟微服务还是很多不同。
   > 整体，水平多层，按层级划分部门，粗粒度，有复杂组件，业务逻辑跨多个领域，ESB充当服务之间的通信。

## 技术实现
### Spring Boot + Spring Cloud （Liquibase、Swagger、Sonar）

### Spring Boot

**特点**

1. 快速构建Spring应用
2. 内嵌tomcat、jetty容器，无需单独安装容器
3. 简化了maven、gradle配置
4. 通过注解自动化配置了Spring，实现零配置
5. 可以和其他主流框架无缝集成，如Spring Cloud
6. jar包直接运行。
   
### Spring Cloud

**特点**

1. 功能齐全
2. 标准化
3. 简单方便
4. 按需取用
5. 轻量
6. 易扩展、易维护
7. 可复用性

**服务管理**

**注册中心-Eureka**

* 服务端和客户端，发现和被发现-注册和被注册的关系

* 发现实际的服务的网络地址，便于被外界发现和使用。

**网关-Zuul**（智能路由，类似的有Nginx）

* 最重要的作用：**为前台提供后台服务的聚合**，提供一个统一的服务出口，解除它们之间的耦合，同时负责鉴权、**认证**、**安全和调度**。过滤器实现。

* **反向代理**：代理的是服务端，前台不需要知道真正的服务端是谁，交给Zuul负责路由到合适的服务上（负载均衡）。路由匹配。

* **正向代理**:代理的是客户端，（类似代购，商家不知道是谁要买）。

**客户端负载均衡-Ribbon**

也就是选择合适的服务端，减少服务端的压力。


### 微服务架构的通信方式

1. 同步
   * Rest(主流，是一套风格规范，面向资源的)
   * SOAP(面向方法)
   * RPC (dubbo，面向接口)
  
2. 异步
   * 吞吐能力强，需要消息队列！！！
    > JMS、ActiveMQ、Kafka、RabbitMQ。

